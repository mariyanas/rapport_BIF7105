---
title: " Analyse d’expression différentielle pour un séquençage de l’ARN avec edgeR"
author: "-"
date: "12 décembre 2025"
output:
  pdf_document:
    toc: true
    toc_depth: 2
    number_sections: true
    fig_caption: true
fontsize: 12pt
bibliography: references.bib 
csl: vancouver.csl
link-citations: true
toc-title: "Table des matières"
---
```{r set-options, echo=FALSE, cache=FALSE, warning=FALSE}
library(kableExtra)
library(magrittr)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE, fig.pos = "H")

```

<!-- 
Révision critique d'un outil bioinformatique (ou package R): description de 
l'application et des jeux de données, de la problématique, des tests d'hypothèses 
et de la méthode statistique. Inclusion d'un exemple pratique.
-->  
\newpage  
# Résumé
<!-- 
Un résumé de votre étude (1/2 page) 
-->  
Le séquençage de l'ARN (*RNA-seq*) est une méthode permettant de séquencer un 
ensemble de molécules d'ARN. Le séquençage d'ARN est utilisé pour 
déterminer quels segments d'ADN ont été transcrits en ARN et la quantité 
un gène est exprimé, afin de mieux comprendre la fonction des différents gènes [@RNA-seq].

[**edgeR**](https://bioconductor.org/packages/release/bioc/html/edgeR.html) est un 
package R conçu pour l'analyse d'expression différentielle des données 
de « *RNA-seq count* ». Il peut détecter des différences entre deux 
groupes ou plus quand au moins un des groupes a effectué des mesures répétées [@edgeRInfo].

# Introduction  
<!-- 
Une introduction avec les références pertinentes (1 page)
-->
<!-- 
- l’utilisation du package R edgeR pour l’identification de gènes différemment 
  exprimes entre deux classes de spécimen
- L’utilisation du package et les modèles statistiques utilisées pour la 
  normalisation des échantillons et l’analyse des différences d’expression 
  seront présentées. 
-->

L’arrivée du séquençage à haut débit, communément connu sous le nom de Next Generation Sequencing, a révolutionné les études génomiques et de biologie moléculaires. Il permet le séquençage rapide de millions de fragments d’ADN ou d’ARN simultanément, offrant des avancées significatives dans les domaines de l’analyse génomique et de transcriptomique. Une application spécifique du NGS est le séquençage d’ARN (RNA-seq) à haut débit, utilisée pour le profilage de l’expression des gènes et des transcrits. Avec la possibilité d’avoir un si grand nombre de fragments et de segments à analyser, il faut trouver une manière simple et efficace afin d’offrir un sens à ces données. Un tel outil qui permet cette analyse est le package *edgeR*.  
  
*EdgerR*, dont l’acronyme signifie Empirical analysis of Digital Gene Expression in R, est un outil puissant qui analyse les données issues du NGS. Il a originalement été conçu par MD Robinson, DJ McCarthy et GK Smyth en 2008. Il est un projet collaboratif dans la communauté Bioconductor où plusieurs autres chercheurs contribuent encore à son évolution et son bon fonctionnement (Yunshen Chen, Aaron Lun,...). Il se spécialise dans les analyses différentielles sur des données discrètes omiques qui produisent des comptes de fragments d’ARN ou d’ADN. Il est utilisé notamment pour la détection de gènes ou de traits qui ont changé de niveau d’abondance entre des types de cellules, des groupes expérimentaux et pour trouver la cause génomique de maladies.
   
*EdgeR* a été le premier outil à utiliser des modèles linéaires généralisés binomiaux négatifs (BN) afin de modéliser les comptages de lecture dans la recherche du génome. En effet, puisque ces derniers ont souvent une variance beaucoup plus grande que la moyenne, il faut un paramètre de dispersion qui permet la relation *variance > moyenne*. La régression BN est donc un meilleur modèle statistique pour analyser des données de comptages qui représentent une surdispersion. De plus, *edgeR* tient compte de deux variations dans les expérimentations de séquençage de l’ARN. La première est la variation biologique entre les différents groupes ou cellules échantillonnés qui suit une loi de Gamma. La deuxième, la variation technique, incluant les erreurs de mesure et de séquençage, qui suit une loi de Poisson. Ensemble, les comptages de lecture suivent une loi de Gamma-Poisson, c’est-à-dire une loi binomiale négative. 
   
Dans cette revue d'outil, les capacités de modélisation linéaires généralisés de *edgeR* seront démontrés avec une analyse différentielle d'expréssion de gènes entre des transcrits séquencés de cellules cancéreuses et de cellules normales issus du séquençage de l'ARN. L'utilisation du package ainsi que ses différentes fonctions et modèles statistiques pour la préparation de données et l'analyse différentielle seront présentés.  
  
# Méthodologie
<!-- 
Méthodologie (2 à 3 pages)
-->  
Pour démontrer les capacités de **edgeR** et de son utilisation de modèles linéaires généralisés pour l'analyse de données, deux types de tissus seront étudiés chez trois patients: les tissus carcinomes épidermoïdes buccaux et les tissus normaux qui leur correspondent. Ces données proviennent d'une expérience de séquençage d'ARN par paires entreprie par Tuch et al. (cite)  
Le but de l'analyse est de trouver les gènes qui sont différentiellement exprimés entre les cellules cancéreuses et les cellules normales.  

## Téléchargement des données
Nous commonçons par charger les *libraries* pertinentes.
```{r message=FALSE}
library(org.Hs.eg.db)
library(edgeR)
```

data taken from: https://www.doi.org
```{r}
rawdata <- read.delim("TableS1.txt", check.names = FALSE, stringsAsFactors = FALSE)
df <- summary(rawdata) 
```   
```{r, echo = FALSE}
knitr::kable(df, format = "latex", booktabs = TRUE) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```
   
## Création d'un *DGEList object*

* create a DGEList object (https://www.rdocumentation.org/packages/edgeR/versions/3.14.0/topics/DGEList) to hold our read counts 
- This object is used as a container for the counts, and for all the associated metadata eg. sample names, gene names and normalisation factors
```{r}
y <- DGEList(counts=rawdata[,4:9], genes=rawdata[,1:3])
dim(y)
```

## Annotation

```{r}

idfound <- y$genes$RefSeqID %in% mappedRkeys(org.Hs.egREFSEQ)
y <- y[idfound,]
dim(y)
```

```{r}
egREFSEQ <- toTable(org.Hs.egREFSEQ)
#head(egREFSEQ)
m <- match(y$genes$RefSeqID, egREFSEQ$accession)
y$genes$EntrezGene <- egREFSEQ$gene_id[m]
```

```{r}
egSYMBOL <- toTable(org.Hs.egSYMBOL)
#head(egSYMBOL)
m <- match(y$genes$EntrezGene, egSYMBOL$gene_id)
y$genes$Symbol <- egSYMBOL$symbol[m]
genes<-head(y$genes)
```
```{r, echo = FALSE}
knitr::kable(genes, format = "latex", booktabs = TRUE) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```

## Filtrage des gènes 
```{r}
o <- order(rowSums(y$counts))
y <- y[o,]
d <- duplicated(y$genes$Symbol)
y <- y[!d,]
nrow(y)
```

```{r}
y$samples$lib.size <- colSums(y$counts)
```

```{r}
rownames(y$counts) <- rownames(y$genes) <- y$genes$EntrezGene
y$genes$EntrezGene <- NULL
```

## Normalisation

```{r}
y <- normLibSizes(y)
samples<-y$samples
```
```{r, echo = FALSE}
knitr::kable(samples, format = "latex", booktabs = TRUE) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```

# Résultats et discussions
<!-- 
Résultats et discussions (2 à 3 pages)
-->

## Data exploration
```{r, out.width="75%"}
plotMDS(y)
```

## Design matrix
```{r}
Patient <- factor(c(8,8,33,33,51,51))
Tissue <- factor(c("N","T","N","T","N","T"))
dfdm<-data.frame(Sample=colnames(y),Patient,Tissue)
```
```{r, echo = FALSE}
knitr::kable(dfdm, format = "latex", booktabs = TRUE) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```
```{r}
design <- model.matrix(~Patient+Tissue)
rownames(design) <- colnames(y)
```
```{r, echo = FALSE}
knitr::kable(design, format = "latex", booktabs = TRUE) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```

## Dispersion Estimation
```{r, out.width="75%"}
y <- estimateDisp(y, design, robust=TRUE)
y$common.dispersion

plotBCV(y)
```

## Differential expression
```{r}
fit <- glmFit(y, design)
```

```{r}
lrt <- glmLRT(fit)
toptags <- topTags(lrt)
```  
  
```{r, echo = FALSE}
knitr::kable(toptags, format = "latex", booktabs = TRUE, digits = 30) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```  
  
```{r}
colnames(design)
```

```{r}
o <- order(lrt$table$PValue)
cpm<-cpm(y)[o[1:10],]
```
```{r, echo = FALSE}
knitr::kable(cpm, format = "latex", booktabs = TRUE) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```

```{r, out.width="75%"}
summary(decideTests(lrt))

plotMD(lrt)
abline(h=c(-1, 1), col="blue")
```

## Gene Ontology Analysis
```{r}
go <- goana(lrt)
upreg <- topGO(go, ont="BP", sort="Up", n=10, truncate=30)
```  
  
```{r, echo = FALSE}
knitr::kable(upreg, format = "latex", booktabs = TRUE, digits = 20) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```  

```{r}
go <- goana(lrt)
downreg <- topGO(go, ont="BP", sort="Down", n=10, truncate=30)
```  

```{r, echo = FALSE}
knitr::kable(downreg, format = "latex", booktabs = TRUE, digits = 40) %>%
          kable_styling(latex_options = c("scale_down","HOLD_position"))
```

# Conclusion
<!-- 
Conclusion (1/2 page)
-->

# Références
<!-- 
Références en écartant les références de  Wikipedia (1 page maximum)
-->
---
nocite: '@*'
...

